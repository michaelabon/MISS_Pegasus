<!-- mission_data is the big wrapper for all the parts of a mission -->
<mission_data version="1.65">

  <!-- all the things that exist at the start of the mission -->
  <start>
    <create type="station" raceKeys="friendly" hullKeys="base" x="68000" y="0" z="8000" name="DS33" />
    <create type="station" raceKeys="friendly" hullKeys="base" x="74000" y="0" z="26000" name="DS137" />
    <create type="station" raceKeys="friendly" hullKeys="base" x="88000" y="0" z="40000" name="DS40" />
    <create type="player" x="82000" y="0" z="16000" name="Artemis" />
	<create type="neutral" raceKeys="friendly" hullKeys="cargo" x="20000" y="0" z="80000" name="Pegasus" angle="45"/>
	<set_object_property name="Pegasus" property="willAcceptCommsOrders" value="0" />
	<clear_ai name="Pegasus" />
	
	<!-- create the northwest nebulae -->
	<create type="nebulas" count="20" startX="20000" startY="0" startZ="25000" radius="4000" startAngle="0" endAngle="360" randomRange="2000" randomSeed="2039" />
	
	<!-- create the mideast nebulae -->
	<create type="nebulas" count="40" startX="69000" startY="0" startZ="61000" radius="7000" startAngle="0" endAngle="90" randomRange="4000" randomSeed="8273" />

    <big_message title="THE CLIPPED PEGASUS" subtitle1="written by Mike Kenyon"/>
 
    <!--
    <incoming_comms_text from="Admiral Grankov">
      Hello, Captain.  Your mission is to^
      proceed to DS38 and deliver your supplies.^^
      You should be aware of a possibility of Kralien patrols in the sector.^   Good luck, Artemis!
    </incoming_comms_text>
	-->
	<set_timer name="pegasus_distress_timer" seconds="20" />
    <set_timer name="enemy_timer" seconds="20"/>
    <set_timer name="game_timer" seconds="60"/>
  </start>

	<!-- Sound the initial distress call -->
	<event>
		<if_timer_finished name="pegasus_distress_timer" />
		<set_object_property name="Pegasus" property="topSpeed" value="0.00001" />
		<set_object_property name="Pegasus" property="turnRate" value="0.00001" />
		<set_object_property name="Pegasus" property="shieldStateFront" value="100" />
		<set_object_property name="Pegasus" property="shieldStateBack" value="100" />
		<incoming_comms_text from="Pegasus">
			PANPAN, PANPAN! Our engine couplings^
			have sheared completely. Requesting^
			power transfer from all available^
			ships.
		</incoming_comms_text>
	</event>
	
	<!-- Artemis helps the Pegasus -->
	<event>
		<if_exists name="DS137" />
		<if_distance name1="Artemis" name2="Pegasus" pointX="1000" comparator="LESS_EQUAL" />
		<if_distance name1="Artemis" name2="Pegasus" pointZ="1000" comparator="LESS_EQUAL" />
		<direct name="Pegasus" targetName="DS137" scriptThrottle="0.2" />
	</event>
			
	<!-- end game when you destroy all enemies -->
  	<!--	We haven't spawned any enemies yet :)
	<event>
		<if_fleet_count comparator="LESS_EQUAL" value="0"/>
		<big_message title="MISSION SUCCESS" subtitle1="Artemis was victorious. All threats have been neutralized."/>
		<end_mission/>
	</event>
	-->
	
	<!-- end game when the Pegasus reaches the target -->
	<event>
		<if_inside_sphere name="Pegasus" centerX="100000" centerY="0" centerZ="0" radius="30000" />
		<big_message title="MISSION SUCCESS" subtitle1="Artemis was victorious. Pegasus has been rescued." />
		<end_mission/>
	</event>
	
	<!-- end game when you're destroyed -->
	<event>
    	<if_not_exists name="Artemis"/>
    	<big_message title="MISSION FAILED" subtitle1="Artemis was destroyed"/>
    	<end_mission/>
  	</event>

	<!-- end game when Pegasus is destroyed -->
	<event>
		<if_not_exists name="Pegasus"/>
		<big_message title="MISSION FAILED" subtitle1="Pegasus was destroyed"/>
		<end_mission/>
	</event>
	
	<!-- end game when all stations are destroyed -->
	<event>
		<if_not_exists name="DS33"/>
		<if_not_exists name="DS137"/>
		<if_not_exists name="DS40"/>
		<big_message title="MISSION FAILED" subtitle1="All stations were destroyed"/>
		<end_mission/>
	</event>

  


</mission_data>